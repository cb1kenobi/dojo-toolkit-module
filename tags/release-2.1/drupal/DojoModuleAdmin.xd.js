/*
	Copyright (c) 2004-2007, The Dojo Foundation
	All Rights Reserved.

	Licensed under the Academic Free License version 2.1 or above OR the
	modified BSD license. For more information on Dojo licensing, see:

		http://dojotoolkit.org/book/dojo-book-0-9/introduction/licensing
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

dojo._xdResourceLoaded({depends:[["provide","drupal.form.AutoComplete"],["provide","drupal.form.Editor"],["provide","drupal.layout.CollapsiblePane"],["provide","drupal.DojoModuleAdmin"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dijit.form._FormWidget"],["require","dijit.Dialog"],["require","dijit.Tooltip"],["require","dijit.Tree"],["require","dojo.data.ItemFileReadStore"],["require","dojox.collections.ArrayList"]],defineResource:function(_1){if(!_1._hasResource["drupal.PleaseWait"]){_1._hasResource["drupal.PleaseWait"]=true;_1.provide("drupal.PleaseWait");_1.declare("drupal.PleaseWait",[dijit._Widget,dijit._Templated],{templateString:"<span id=\"Shib\"><input dojoAttachPoint=\"_button\" type=\"button\"/><div dojoAttachPoint=\"_contents\"><span class=\"Indicator\">Please wait...</span></div></span>",_button:null,_contents:null,_dialog:null,_form:null,postCreate:function(){var n=this.domNode;while(n&&n.parentNode&&n.tagName.toLowerCase()!="form"){n=n.parentNode;}if(n){this._form=n;}var _3=this.srcNodeRef;this._button.id=_3.id;this._button.name=_3.name;this._button.value=_3.value;this._button.className=_3.className;_1.connect(this._button,"onclick",this,"_showDialog");this._dialog=new dijit.Dialog({templateString:"<div class=\"dijitDialogBox\"><div dojoAttachPoint=\"containerNode\"></div></div>"},this._contents);},_showDialog:function(_4){_1.stopEvent(_4);this._dialog.show();setTimeout(_1.hitch(this,"_submitForm"),500);},_submitForm:function(){if(this._form){this._form.submit();}}});}if(!_1._hasResource["drupal.data.SvnStore"]){_1._hasResource["drupal.data.SvnStore"]=true;_1.provide("drupal.data.SvnStore");_1.declare("drupal.data.SvnStore",_1.data.ItemFileReadStore,{getValues:function(_5,_6){this._assertIsItem(_5);this._assertIsAttribute(_6);if(_6=="children"&&_5.id){var _7=this;var d=_1.xhrGet({url:this._jsonFileUrl+_5.id,sync:true,handleAs:"json",load:function(_9,_a){for(var i=0;i<_9.length;i++){_9[i]["name"]=[_9[i]["name"]];_7._arrayOfAllItems.push(_9[i]);_9[i][_7._storeRefPropName]=_7;_9[i][_7._itemNumPropName]=_7._arrayOfAllItems.length-1;_5["children"].push(_9[i]);}}});}return _5[_6]||[];},hasAttribute:function(_c,_d){if(_d=="children"){return true;}return this.inherited("hasAttribute",arguments);}});}if(!_1._hasResource["drupal.form.CustomizeToolbar"]){_1._hasResource["drupal.form.CustomizeToolbar"]=true;_1.provide("drupal.form.CustomizeToolbar");_1.declare("drupal.form.CustomizeToolbar",[dijit.form._FormWidget,dijit._Templated],{templateString:"<div class=\"dojoCustomizeToolbar\">\n\t<input dojoAttachPoint=\"_inputField\" type=\"hidden\"/>\n\t<div class=\"list\"><ul dojoAttachPoint=\"_availableList\"></ul></div>\n\t<div class=\"buttonColumn\">\n\t\t<input type=\"button\" class=\"button\" dojoAttachPoint=\"_addButton,focusNode\" dojoAttachEvent=\"onclick:_addItem\" value=\"Add &gt;\"/><br/>\n\t\t<input type=\"button\" class=\"button\" dojoAttachPoint=\"_removeButton\" dojoAttachEvent=\"onclick:_removeItem\" value=\"&lt; Remove\"/><br/>\n\t\t<input type=\"button\" class=\"button\" dojoAttachEvent=\"onclick:_restoreDefaults\" value=\"Defaults\"/>\n\t</div>\n\t<div class=\"list\"><ul dojoAttachPoint=\"_selectedList\"></ul></div>\n\t<div class=\"buttonColumn\">\n\t\t<input type=\"button\" class=\"button\" dojoAttachPoint=\"_moveUpButton\" dojoAttachEvent=\"onclick:_moveItemUp\" value=\"Move Up\"/><br/>\n\t\t<input type=\"button\" class=\"button\" dojoAttachPoint=\"_moveDownButton\" dojoAttachEvent=\"onclick:_moveItemDown\" value=\"Move Down\"/>\n\t</div>\n</div>\n",_inputField:null,_availableList:null,_selectedList:null,_addButton:null,_removeButton:null,_moveUpButton:null,_moveDownButton:null,toolbarPlugins:[],defaultPlugins:[],_selectedItem:null,postCreate:function(){var n=this.srcNodeRef;this._inputField.id=n.id;this._inputField.name=n.name;this._inputField.value=n.value;this._disableButtons();this._populateLists();},_populateLists:function(){var _f=new dojox.collections.ArrayList(this._inputField.value.split(","));_1.query("li",this._availableList).forEach(function(n){_1._destroyElement(n);});_1.query("li",this._selectedList).forEach(function(n){_1._destroyElement(n);});for(var i=0;i<this.toolbarPlugins.length;i++){if(i==0||!_f.contains(i)){this._availableList.appendChild(this._createListItem(i));}}for(var i=0;i<_f.count;i++){this._selectedList.appendChild(this._createListItem(_f.item(i)));}},_createListItem:function(idx){var _14=this.toolbarPlugins[idx];var _15=document.createElement("span");_15.className=(_14.label||_14.stylelist?"":"dijitEditorIcon")+(_14["class"]?" "+_14["class"]:"");if(_14.style){_15.cssText=_14.style;}_15.innerHTML=_14.label?_14.label:"&nbsp;";var _16=document.createElement("span");_16.innerHTML=_14.description;var li=document.createElement("li");li.idx=idx;li.style.clear="both";li.appendChild(_15);li.appendChild(_16);_1.connect(li,"onmousedown",this,"_onClick");return li;},_disableButtons:function(){this._addButton.disabled=true;this._removeButton.disabled=true;this._moveUpButton.disabled=true;this._moveDownButton.disabled=true;},_enableButtons:function(_18){this._addButton.disabled=_18;this._removeButton.disabled=!_18;this._moveUpButton.disabled=!_18;this._moveDownButton.disabled=!_18;},_restoreDefaults:function(){this._inputField.value=this.defaultPlugins;this._populateLists();},_onClick:function(evt){var li=evt.target;while(li&&li.parentNode&&li.tagName.toLowerCase()!="li"){li=li.parentNode;}if(!li){return;}if(this._selectedItem){this._selectedItem.className="";this._selectedItem=null;this._disableButtons();}this._selectedItem=li;li.className="selected";this._enableButtons(li.parentNode==this._selectedList);},_scrollToBottom:function(_1b){while(_1b&&_1b.parentNode&&_1b.tagName.toLowerCase()!="div"){_1b=_1b.parentNode;}if(_1b){_1b.scrollTop=999;}},_addItem:function(){if(this._selectedItem){if(this._selectedItem.idx==0){var _1c=this._selectedItem.cloneNode(true);_1c.idx=0;_1.connect(_1c,"onmousedown",this,"_onClick");this._selectedItem.className="";this._selectedItem=_1c;this._selectedList.appendChild(_1c);}else{this._selectedList.appendChild(this._selectedItem);}this._scrollToBottom(this._selectedList);this._enableButtons(true);}this._serializeSelected();},_removeItem:function(){if(this._selectedItem){if(this._selectedItem.idx==0){_1._destroyElement(this._selectedItem);this._selectedItem=null;this._disableButtons();}else{this._availableList.appendChild(this._selectedItem);this._scrollToBottom(this._availableList);this._enableButtons(false);}}this._serializeSelected();},_moveItemUp:function(){if(this._selectedItem){var _1d=this._selectedItem;do{_1d=_1d.previousSibling;}while(_1d&&_1d.nodeType!=1);if(_1d){_1.place(this._selectedItem,_1d,"before");this._serializeSelected();}}},_moveItemDown:function(){if(this._selectedItem){var _1e=this._selectedItem;do{_1e=_1e.nextSibling;}while(_1e&&_1e.nodeType!=1);if(_1e){_1.place(this._selectedItem,_1e,"after");this._serializeSelected();}}},_serializeSelected:function(){var _1f=[];var lis=this._selectedList.getElementsByTagName("li");for(var i=0;i<lis.length;i++){_1f.push(lis[i].idx);}this._inputField.value=_1f.join(",");}});}if(!_1._hasResource["drupal.form.GoogleMapKeyTable"]){_1._hasResource["drupal.form.GoogleMapKeyTable"]=true;_1.provide("drupal.form.GoogleMapKeyTable");_1.declare("drupal.form.GoogleMapKeyTable",[dijit.form._FormWidget,dijit._Templated],{templateString:"<div><table class=\"dojoGoogleMapsKeyTable\" dojoAttachPoint=\"_table\"><thead><th colspan=\"2\">URL</th><th>Key</th></thead><tbody dojoAttachPoint=\"_tbody\"></tbody></table><div><a dojoAttachPoint=\"focusNode\" dojoAttachEvent=\"onclick:_addKey\" href=\"#\">Add new key</a></div><input type=\"hidden\" dojoAttachPoint=\"_saveField\" /></div>",_counter:0,_keys:[],_table:null,_tbody:null,_saveField:null,postCreate:function(){var _22=this.srcNodeRef;this._saveField.name=_22.name;this._saveField.id=_22.id;this._saveField.value=_22.value;var _23=_22.value.split("|");for(var i=0;i<_23.length;i++){if(_23[i].length){var p=_23[i].indexOf(",");this._buildRow(_23[i].substring(0,p),_23[i].substring(p+1));}}this._displayTable();},_fillContent:function(){},_buildRow:function(key,url){var idx=this._counter++;var _29=document.createElement("td");_29.innerHTML="http:// ";var _2a=document.createElement("td");_2a.style.width="40%";_2a.appendChild(this._buildInput("url",url,idx));var _2b=document.createElement("td");_2b.style.width="60%";_2b.appendChild(this._buildInput("key",key,idx));var _2c=document.createElement("td");var a=document.createElement("a");a.href="#";a.idx=idx;a.innerHTML="delete";_1.connect(a,"onclick",this,"_deleteKey");_2c.appendChild(a);var tr=document.createElement("tr");tr.className=idx%2==0?"even":"odd";tr.appendChild(_29);tr.appendChild(_2a);tr.appendChild(_2b);tr.appendChild(_2c);this._tbody.appendChild(tr);setTimeout(function(){_1.query(":last-child",_2a)[0].focus();},100);this._keys.push({idx:idx,key:key,url:url,row:tr});},_buildInput:function(_2f,_30,idx){var i=document.createElement("input");i.className="form-text";i.type="text";i.value=_30;i.fieldType=_2f;i.idx=idx;_1.connect(i,"onblur",this,"_updateKey");return i;},_addKey:function(evt){_1.stopEvent(evt);this._buildRow("","");this._displayTable();},_deleteKey:function(evt){_1.stopEvent(evt);for(var i=0;i<this._keys.length;i++){if(this._keys[i].idx==evt.target.idx){_1._destroyElement(this._keys[i].row);this._keys.splice(i,1);}}var j=0;_1.query("tr",this._tbody).forEach(function(e){e.className=j++%2==0?"even":"odd";});this._serialize();this._displayTable();},_displayTable:function(){_1.style(this._table,"display",this._keys.length>0?"":"none");},_updateKey:function(evt){var t=evt.target;for(var i=0;i<this._keys.length;i++){if(this._keys[i].idx==t.idx){this._keys[i][t.fieldType]=_1.string.trim(t.value);this._serialize();break;}}},_serialize:function(){var b="";for(var i=0;i<this._keys.length;i++){this._keys[i].key=_1.string.trim(this._keys[i].key);this._keys[i].url=_1.string.trim(this._keys[i].url);if(this._keys[i].key.length||this._keys[i].url.length){b+=(b.length?"|":"")+this._keys[i].key+","+this._keys[i].url;}}this._saveField.value=b;}});}if(!_1._hasResource["drupal.form.SvnTree"]){_1._hasResource["drupal.form.SvnTree"]=true;_1.provide("drupal.form.SvnTree");_1.declare("drupal.form.SvnTree",dijit._Widget,{_tree:null,postCreate:function(){var _3d=this;var d=document.createElement("div");_1.place(d,this.domNode,"after");this._tree=new dijit.Tree({query:{type:"dir"},labelAttr:"name",typeAttr:"type",store:new drupal.data.SvnStore({url:"/dojo/svn"}),persist:false,getIconClass:function(){return "dojoSvnTreeFolderClosed";}},d);this._setupNode(this._tree);_1.addClass(this._tree.domNode,"dojoSvnTree");},_createToolTip:function(_3f){var d=document.createElement("div");d.innerHTML="<div><strong>"+_3f.label+"</strong></div><div>Revision: "+_3f.item.revision+"</div><div>Author: "+_3f.item.author+"</div><div>Date: "+_3f.item.date+"</div>";_1.body().appendChild(d);var t=new dijit.Tooltip({connectId:[_3f.iconNode,_3f.labelNode]},d);this._setupNode(_3f);},_setupNode:function(_42){_1.connect(_42,"addChild",this,"_createToolTip");_1.connect(_42,"_setExpando",function(){_42.iconNode.className="dijitInline dijitTreeIcon dojoSvnTreeFolder"+(_42.isExpanded?"Opened":"Closed");});}});}if(!_1._hasResource["drupal.DojoModuleAdmin"]){_1._hasResource["drupal.DojoModuleAdmin"]=true;_1.provide("drupal.DojoModuleAdmin");}}});